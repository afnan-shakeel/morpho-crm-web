import{a as tt}from"./chunk-ICXQ7NUM.js";import{a as et}from"./chunk-WF3HQLNG.js";import{a as it}from"./chunk-4ZAQMZ6A.js";import{a as rt}from"./chunk-UY4LSRMA.js";import"./chunk-T4HB4AXC.js";import{B as z,C as Q,D as y,E as U,F as Y,H as $,I as J,K,M as W,S as X,U as Z,v as H,w as B,x as G}from"./chunk-XICAGMBR.js";import{$ as S,A as _,Ab as V,Db as p,Ea as w,Eb as L,Fb as R,Gb as P,Hb as j,Pa as C,Q as M,V as d,_ as b,aa as E,ba as q,bb as f,cb as h,gb as g,hb as r,ib as o,jb as m,la as I,o as v,pb as N,s as x,tb as c,vb as O,yb as D,za as s,zb as A}from"./chunk-MI4VSIZJ.js";function nt(a,e){if(a&1&&(r(0,"div",8),p(1),o()),a&2){let t,i=O();s(),R(" ",!((t=i.opportunityStageForm.get("stageName"))==null||t.errors==null)&&t.errors.required?"Stage name is required.":""," ")}}function pt(a,e){if(a&1&&(r(0,"div",8),p(1),o()),a&2){let t,i=O();s(),j(" ",!((t=i.opportunityStageForm.get("probability"))==null||t.errors==null)&&t.errors.required?"Probability is required.":""," ",!((t=i.opportunityStageForm.get("probability"))==null||t.errors==null)&&t.errors.min?"Minimum value is 0.":""," ",!((t=i.opportunityStageForm.get("probability"))==null||t.errors==null)&&t.errors.max?"Maximum value is 100.":""," ")}}function st(a,e){if(a&1&&(r(0,"div",8),p(1),o()),a&2){let t,i=O();s(),P(" ",!((t=i.opportunityStageForm.get("sequence"))==null||t.errors==null)&&t.errors.required?"Sequence is required.":""," ",!((t=i.opportunityStageForm.get("sequence"))==null||t.errors==null)&&t.errors.min?"Minimum value is 0.":""," ")}}var k=class a{fb=d(X);stageId=null;stageData=null;isEditMode=!1;formTitle="Create Opportunity Stage";formSubmit=new w;formCancel=new w;ngOnChanges(e){e.stageId&&this.stageId&&this.populateForm(this.stageId)}populateForm(e){this.stageData&&this.opportunityStageForm.patchValue({stageName:this.stageData.name,probability:this.stageData.probability,isClosed:this.stageData.is_closed,sequence:this.stageData.sequence})}opportunityStageForm=this.fb.group({stageName:["",y.required],probability:[0,[y.required,y.min(0),y.max(100)]],isClosed:[!1,y.required],sequence:[0,[y.required,y.min(0)]]});onSubmit(){this.opportunityStageForm.markAllAsTouched(),this.opportunityStageForm.valid&&(this.formSubmit.emit({name:this.opportunityStageForm.value.stageName,probability:this.opportunityStageForm.value.probability,is_closed:this.opportunityStageForm.value.isClosed,sequence:this.opportunityStageForm.value.sequence}),this.opportunityStageForm.reset())}onCancel(){this.formCancel.emit(),this.opportunityStageForm.reset()}static \u0275fac=function(t){return new(t||a)};static \u0275cmp=C({type:a,selectors:[["app-opportunity-stage-form"]],inputs:{stageId:"stageId",stageData:"stageData",isEditMode:"isEditMode",formTitle:"formTitle"},outputs:{formSubmit:"formSubmit",formCancel:"formCancel"},features:[I],decls:42,vars:5,consts:[[3,"ngSubmit","formGroup"],[1,"text-base/7","font-semibold","text-gray-900","dark:text-white"],[1,"mt-1","text-sm/6","text-gray-600","dark:text-gray-400"],[1,"mt-4","grid","grid-cols-2","gap-y-4","gap-x-4"],[1,"col-span-2"],["for","stageName",1,"block","text-sm/6","font-medium","text-gray-900","dark:text-white"],[1,"mt-2"],["id","stageName","type","text","formControlName","stageName","placeholder","Enter stage name",1,"block","w-full","rounded-md","bg-white","px-3","py-1.5","text-base","text-gray-900","outline-1","-outline-offset-1","outline-gray-300","placeholder:text-gray-400","focus:outline-2","focus:-outline-offset-2","focus:outline-primary-600","sm:text-sm/6","dark:bg-white/5","dark:text-white","dark:outline-white/10","dark:placeholder:text-gray-500","dark:focus:outline-primary-500"],[1,"mt-1","text-xs","text-red-600","dark:text-red-400"],["for","probability",1,"block","text-sm/6","font-medium","text-gray-900","dark:text-white"],["id","probability","type","number","formControlName","probability","placeholder","Enter probability",1,"block","w-full","rounded-md","bg-white","px-3","py-1.5","text-base","text-gray-900","outline-1","-outline-offset-1","outline-gray-300","placeholder:text-gray-400","focus:outline-2","focus:-outline-offset-2","focus:outline-primary-600","sm:text-sm/6","dark:bg-white/5","dark:text-white","dark:outline-white/10","dark:placeholder:text-gray-500","dark:focus:outline-primary-500"],["for","sequence",1,"block","text-sm/6","font-medium","text-gray-900","dark:text-white"],["id","sequence","type","number","formControlName","sequence","placeholder","Enter sequence",1,"block","w-full","rounded-md","bg-white","px-3","py-1.5","text-base","text-gray-900","outline-1","-outline-offset-1","outline-gray-300","placeholder:text-gray-400","focus:outline-2","focus:-outline-offset-2","focus:outline-primary-600","sm:text-sm/6","dark:bg-white/5","dark:text-white","dark:outline-white/10","dark:placeholder:text-gray-500","dark:focus:outline-primary-500"],[1,"flex","gap-3"],[1,"flex","h-6","shrink-0","items-center"],[1,"group","grid","size-4","grid-cols-1"],["id","isClosed","type","checkbox","name","isClosed","formControlName","isClosed","aria-describedby","isClosed-description",1,"col-start-1","row-start-1","appearance-none","rounded-sm","border","border-gray-300","bg-white","checked:border-primary-600","checked:bg-primary-600","indeterminate:border-primary-600","indeterminate:bg-primary-600","focus-visible:outline-2","focus-visible:outline-offset-2","focus-visible:outline-primary-600","disabled:border-gray-300","disabled:bg-gray-100","disabled:checked:bg-gray-100","dark:border-white/10","dark:bg-white/5","dark:checked:border-primary-500","dark:checked:bg-primary-500","dark:indeterminate:border-primary-500","dark:indeterminate:bg-primary-500","dark:focus-visible:outline-primary-500","dark:disabled:border-white/5","dark:disabled:bg-white/10","dark:disabled:checked:bg-white/10","forced-colors:appearance-auto"],["viewBox","0 0 14 14","fill","none",1,"pointer-events-none","col-start-1","row-start-1","size-3.5","self-center","justify-self-center","stroke-white","group-has-disabled:stroke-gray-950/25","dark:group-has-disabled:stroke-white/25"],["d","M3 8L6 11L11 3.5","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"opacity-0","group-has-checked:opacity-100"],["d","M3 7H11","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"opacity-0","group-has-indeterminate:opacity-100"],[1,"text-sm/6"],["for","isClosed",1,"font-medium","text-gray-900","dark:text-white"],["id","isClosed-description",1,"text-gray-500","dark:text-gray-400"],[1,"mt-6","flex","items-center","justify-end","gap-x-6"],["type","button",1,"text-sm/6","font-semibold","text-gray-900","dark:text-white",3,"click"],["type","submit",1,"rounded-md","bg-primary-500","px-3","py-2","text-sm","font-semibold","text-white","shadow-xs","hover:bg-primary-500/80","focus-visible:outline-2","focus-visible:outline-offset-2","focus-visible:outline-primary-600","dark:bg-primary-500","dark:shadow-none","dark:focus-visible:outline-primary-500"]],template:function(t,i){if(t&1&&(r(0,"form",0),c("ngSubmit",function(){return i.onSubmit()}),r(1,"h2",1),p(2),o(),r(3,"p",2),p(4,"A unique opportunity stage for your sales process "),o(),r(5,"div",3)(6,"div",4)(7,"label",5),p(8,"Stage Name"),o(),r(9,"div",6),m(10,"input",7),o(),f(11,nt,2,1,"div",8),o(),r(12,"div",4)(13,"label",9),p(14,"Probability"),o(),r(15,"div",6),m(16,"input",10),o(),f(17,pt,2,3,"div",8),o(),r(18,"div",4)(19,"label",11),p(20,"Sequence"),o(),r(21,"div",6),m(22,"input",12),o(),f(23,st,2,2,"div",8),o(),r(24,"div",4)(25,"div",13)(26,"div",14)(27,"div",15),m(28,"input",16),E(),r(29,"svg",17),m(30,"path",18)(31,"path",19),o()()(),q(),r(32,"div",20)(33,"label",21),p(34,"Is this a closed stage?"),o(),r(35,"p",22),p(36," Indicates if this stage is a closed stage or final stage in the sales process. "),o()()()()(),r(37,"div",23)(38,"button",24),c("click",function(){return i.onCancel()}),p(39,"Cancel"),o(),r(40,"button",25),p(41,"Save"),o()()()),t&2){let n,l,u;g("formGroup",i.opportunityStageForm),s(2),L(i.formTitle),s(9),h((n=i.opportunityStageForm.get("stageName"))!=null&&n.invalid&&((n=i.opportunityStageForm.get("stageName"))!=null&&n.dirty||(n=i.opportunityStageForm.get("stageName"))!=null&&n.touched)?11:-1),s(6),h((l=i.opportunityStageForm.get("probability"))!=null&&l.invalid&&((l=i.opportunityStageForm.get("probability"))!=null&&l.dirty||(l=i.opportunityStageForm.get("probability"))!=null&&l.touched)?17:-1),s(6),h((u=i.opportunityStageForm.get("sequence"))!=null&&u.invalid&&((u=i.opportunityStageForm.get("sequence"))!=null&&u.dirty||(u=i.opportunityStageForm.get("sequence"))!=null&&u.touched)?23:-1)}},dependencies:[Z,$,Q,J,z,U,Y,K,W],encapsulation:2})};var T=class a{api=d(H);errorHandler=d(G);getOpportunityStages(){return this.api.get("opportunities/stages").pipe(_(e=>(this.errorHandler.handleError(e),v([]))),x(e=>e.data))}createOpportunityStage(e){return this.api.post("opportunities/stages/create",e).pipe(_(t=>(this.errorHandler.handleError(t),v(null))),x(t=>t.data))}updateOpportunityStage(e,t){return this.api.put(`opportunities/stages/${e}`,t).pipe(_(i=>(this.errorHandler.handleError(i),v(null))),x(i=>i.data))}static \u0275fac=function(t){return new(t||a)};static \u0275prov=M({token:a,factory:a.\u0275fac,providedIn:"root"})};var lt=["opportunityStageFormModal"];function ut(a,e){if(a&1&&(r(0,"div"),m(1,"app-custom-datatable",13),o()),a&2){let t=O();s(),g("records",t.opporuntityStages)("columns",t.opporuntityStagesListingColumns)("currentPage",1)("pageSize",t.opporuntityStages.length)("totalRecords",t.opporuntityStages.length)("rowActions",t.rowActions)("disableSearch",!0)}}function mt(a,e){a&1&&(r(0,"div"),p(1," I need a typing break! "),o())}var F=class a{toastService=d(B);opportunityStageService=d(T);pageBreadcrumbs=[{label:"Home",path:"/"},{label:"Opportunities Master",path:"/admin/opportunities-master"}];contentTabs=[{id:"opportunity-stage",label:"Opportunity Stage",active:!0},{id:"opportunity-stage-tasks",label:"Opportunity Stage Tasks",active:!0}];currentContent="opportunity-stage";opporuntityStages=[];opporuntityStagesListingColumns=[{field:"stageId",label:"Stage ID",hidden:!0},{field:"name",label:"Stage Name"},{field:"probability",label:"Probability (%)"},{field:"is_closed",label:"Closed Stage",cellTemplate:"boolean"},{field:"sequence",label:"Sequence"},{field:"createdAt",label:"Created Time",cellTemplate:"datetime"}];rowActions=[{label:"Edit",actionCallback:e=>{this.openOpportunityStageFormModal(e)}}];ngOnInit(){this.loadOpportunityStages()}onContentTabChange(e){this.currentContent=e.tab.id,e.tab.id==="opportunity-stage"&&this.loadOpportunityStages()}onCreateMasterData(){this.currentContent==="opportunity-stage"&&this.openOpportunityStageFormModal()}loadOpportunityStages(){this.opportunityStageService.getOpportunityStages().subscribe(e=>{this.opporuntityStages=e})}opportunityStageFormModal;selectedOpportunityStageData=null;opportunityFormTitle="Create Opportunity Stage";openOpportunityStageFormModal(e=null){this.selectedOpportunityStageData=e,e&&e.stageId?(this.opportunityFormTitle="Edit Opportunity Stage",this.selectedOpportunityStageData=e):(this.opportunityFormTitle="Create Opportunity Stage",this.selectedOpportunityStageData=null),this.opportunityStageFormModal.open()}closeOpportunityStageFormModal(){this.opportunityStageFormModal.close(),this.selectedOpportunityStageData=null}onOpportunityStageFormSubmit(e){if(!e){this.closeOpportunityStageFormModal();return}this.selectedOpportunityStageData&&this.selectedOpportunityStageData.stageId?this.opportunityStageService.updateOpportunityStage(this.selectedOpportunityStageData.stageId,{name:e.name,probability:e.probability,is_closed:e.is_closed,sequence:e.sequence}).subscribe({next:t=>{if(t&&t.stageId){this.toastService.success("Opportunity Stage updated successfully."),this.loadOpportunityStages(),this.closeOpportunityStageFormModal();return}}}):this.opportunityStageService.createOpportunityStage({name:e.name,probability:e.probability,is_closed:e.is_closed,sequence:e.sequence}).subscribe({next:t=>{if(t&&t.stageId){this.toastService.success("Opportunity Stage created successfully."),this.loadOpportunityStages(),this.closeOpportunityStageFormModal();return}}})}static \u0275fac=function(t){return new(t||a)};static \u0275cmp=C({type:a,selectors:[["app-opportunities-master-listing"]],viewQuery:function(t,i){if(t&1&&D(lt,5),t&2){let n;A(n=V())&&(i.opportunityStageFormModal=n.first)}},decls:16,vars:8,consts:[["opportunityStageFormModal",""],[1,"px-4","sm:px-6","lg:px-8"],[1,"sm:flex","sm:items-center"],[1,"sm:flex-auto"],[1,""],["description","Manage the master list of all opportunities related data.",3,"title","breadcrumbs"],[1,"sm:mt-0","sm:ml-16","sm:flex-none"],["type","button",1,"block","rounded-md","bg-primary-500","px-3","py-2","text-center","text-sm","font-semibold","text-white","shadow-xs","hover:bg-primary-500/80","focus-visible:outline-2","focus-visible:outline-offset-2","focus-visible:outline-primary-500","dark:bg-primary-500","dark:hover:bg-indigo-400","dark:focus-visible:outline-primary-500",3,"click"],[1,"mt-6"],["mode","content",3,"tabChange","tabs"],[1,"p-2","bg-gray-50/20","dark:bg-gray-800","rounded-lg"],[3,"closeModal","modalId"],[3,"formCancel","formSubmit","formTitle","stageData","stageId"],[3,"records","columns","currentPage","pageSize","totalRecords","rowActions","disableSearch"]],template:function(t,i){if(t&1){let n=N();r(0,"div",1)(1,"div",2)(2,"div",3)(3,"div",4),m(4,"app-page-heading",5),o()(),r(5,"div",6)(6,"button",7),c("click",function(){return b(n),S(i.onCreateMasterData())}),p(7," Create New Master "),o()()(),r(8,"div",8)(9,"app-tabs",9),c("tabChange",function(u){return b(n),S(i.onContentTabChange(u))}),o(),r(10,"div",10),f(11,ut,2,7,"div")(12,mt,2,0,"div"),o()()(),r(13,"app-modal-small",11,0),c("closeModal",function(){return b(n),S(i.closeOpportunityStageFormModal())}),r(15,"app-opportunity-stage-form",12),c("formCancel",function(){return b(n),S(i.closeOpportunityStageFormModal())})("formSubmit",function(u){return b(n),S(i.onOpportunityStageFormSubmit(u))}),o()()}if(t&2){let n;s(4),g("title","Opportunity Master")("breadcrumbs",i.pageBreadcrumbs),s(5),g("tabs",i.contentTabs),s(2),h((n=i.currentContent)==="opportunity-stage"?11:n==="opportunity-stage-tasks"?12:-1),s(2),g("modalId","opportunity-stage-form-modal"),s(2),g("formTitle",i.opportunityFormTitle)("stageData",i.selectedOpportunityStageData)("stageId",(i.selectedOpportunityStageData==null?null:i.selectedOpportunityStageData.stageId)||null)}},dependencies:[rt,et,tt,it,k],encapsulation:2})};var zt=[{path:"list",component:F}];export{zt as OPPORTUNITY_MASTER_ROUTES};

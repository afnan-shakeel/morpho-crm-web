import{b as zt,c as Qt,d as Wt}from"./chunk-POUALKY6.js";import"./chunk-GTAFJL4P.js";import{a as ht}from"./chunk-XUUMAHLE.js";import{a as xt}from"./chunk-GK3J37A3.js";import{c as $t}from"./chunk-VCNEJXGR.js";import{a as jt}from"./chunk-C3RZJLGD.js";import{a as Gt}from"./chunk-J65LRALL.js";import{a as ft,b as qt}from"./chunk-Q7BWANAG.js";import"./chunk-ZZ24IKKX.js";import{a as gt}from"./chunk-IFSTEAGB.js";import"./chunk-BYXBJQAS.js";import{a as Ut}from"./chunk-T4HB4AXC.js";import{C as pt,E as st,F as lt,H as ut,K as dt,M as ct,N as Vt,O as Bt,P as Rt,S as mt,T as Ht,U as yt,g as H,i as Nt,j as Pt,o as Lt,v as rt,w as P,x as at}from"./chunk-YMK4QOIO.js";import{$ as x,$a as It,A as C,Ab as Y,Cb as At,Db as s,Ea as N,Eb as E,Fb as b,Ka as Tt,Lb as J,Ob as Mt,Pa as k,Q as nt,V as y,_ as h,a as Ft,aa as D,b as Dt,ba as T,bb as g,cb as f,db as V,eb as I,fb as F,gb as m,hb as r,ia as $,ib as p,jb as v,kb as u,la as Q,lb as d,mb as R,o as w,pb as A,s as _,tb as S,ub as j,vb as c,yb as W,za as a,zb as Z}from"./chunk-MI4VSIZJ.js";var M=class o{api=y(rt);toastService=y(P);errorHandler=y(at);getOpportunities(e,t,i,n,l,O=!1){let q={eagerFetch:O,globalSearch:{value:e||""},filters:t||[],sort:i||{},pagination:{page:n||1,limit:l||10}};return this.api.post("opportunities/search",q).pipe(C(B=>(this.errorHandler.handleError(B),w({}))),_(B=>B.data))}getOpportunityLookupData(){return this.api.get("opportunities/lookup-data").pipe(C(e=>(console.error("Error fetching opportunity lookup data:",e),this.toastService.error("Failed to fetch opportunity lookup data. Please try again later."),w({}))),_(e=>e.data))}createOpportunity(e){return this.api.post("opportunities/create",e).pipe(C(t=>(this.errorHandler.handleError(t),w({}))),_(t=>t.data))}updateOpportunity(e,t){return this.api.post(`opportunities/${e}/update`,t).pipe(C(i=>(this.errorHandler.handleError(i),w({}))),_(i=>i.data))}markOpportunityAsClosed(e,t){let i={status:t};return this.api.post(`opportunities/${e}/close`,i).pipe(C(n=>(this.errorHandler.handleError(n),w(null))),_(n=>n.data))}getOpportunityById(e,t=!1){let i=new Nt;return t&&(i=i.set("eagerFetch","true")),this.api.get(`opportunities/${e}`,i).pipe(C(n=>(console.error("Error fetching opportunity:",n),this.toastService.error("Failed to fetch opportunity details. Please try again later."),w({}))),_(n=>n.data))}updateOpportunityStage(e,t,i){let n={opportunityId:e,stageId:t,lossReasonCode:i||null};return this.api.post(`opportunities/stage-update/${e}`,n).pipe(C(l=>(this.errorHandler.handleError(l),w({}))),_(l=>l.data))}getOpportunityLogs(e){return this.api.get(`opportunities/${e}/logs`).pipe(C(t=>(console.error("Error fetching opportunity logs:",t),this.toastService.error("Failed to fetch opportunity logs. Please try again later."),w([]))),_(t=>t.data))}createOpportunityActivity(e,t){return this.api.post(`opportunities/${e}/activity/create`,t).pipe(C(i=>this.errorHandler.handleError(i)),_(i=>i.data))}updateOpportunityActivity(e,t,i){return this.api.post(`opportunities/${e}/activity/update/${t}`,i).pipe(C(n=>this.errorHandler.handleError(n)),_(n=>n.data))}getOpportunityActivities(e){return this.api.get(`opportunities/${e}/activities`).pipe(C(t=>(console.error("Error fetching opportunity activities:",t),this.toastService.error("Failed to fetch opportunity activities. Please try again later."),w([]))),_(t=>t.data))}getOpportunityActivityById(e,t){return this.api.get(`opportunities/${e}/activity/${t}`).pipe(C(i=>(console.error("Error fetching opportunity activity:",i),this.toastService.error("Failed to fetch opportunity activity. Please try again later."),w({}))),_(i=>i.data))}getOpportunityStages(){return this.api.get("opportunities/stages").pipe(C(e=>(console.error("Error fetching opportunity stages:",e),this.toastService.error("Failed to fetch opportunity stages. Please try again later."),w([]))),_(e=>e.data))}searchOpportunitiesForAutocomplete(e,t=10){let i={globalSearch:{value:e||""},filters:[],sort:{field:"opportunityName",direction:"asc"},pagination:{page:1,limit:t}};return this.api.post("opportunities/search",i).pipe(C(n=>(this.errorHandler.handleError(n),w([]))),_(n=>n.data?.data||[]))}deleteOpportunity(e){return this.api.delete(`opportunities/${e}`).pipe(C(t=>(this.errorHandler.handleError(t),w(!1))),_(t=>(this.toastService.success("Opportunity deleted successfully"),!0)))}static \u0275fac=function(t){return new(t||o)};static \u0275prov=nt({token:o,factory:o.\u0275fac,providedIn:"root"})};var X=(i=>(i.Active="Active",i.Won="Won",i.Lost="Lost",i))(X||{});function Yt(o,e){if(o&1&&(r(0,"div",10),s(1),p()),o&2){let t,i=c();a(),b(" ",!((t=i.opportunityForm.get("opportunityName"))==null||t.errors==null)&&t.errors.required?"Opportunity name is required.":""," ")}}function Kt(o,e){if(o&1&&(r(0,"div",10),s(1),p()),o&2){let t,i=c();a(),b(" ",!((t=i.opportunityForm.get("opportunityOwnerId"))==null||t.errors==null)&&t.errors.required?"Opportunity Owner is required.":""," ")}}function Jt(o,e){if(o&1&&(r(0,"el-option",21)(1,"div",40)(2,"span",41),s(3),p()()()),o&2){let t=e.$implicit;m("id",J(t.accountId)),It("value",t.companyName),a(3),E(t.companyName)}}function Xt(o,e){if(o&1&&(r(0,"div",10),s(1),p()),o&2){let t,i=c();a(),b(" ",!((t=i.opportunityForm.get("accountName"))==null||t.errors==null)&&t.errors.required?"Account name is required.":""," ")}}function te(o,e){if(o&1&&(r(0,"div",10),s(1),p()),o&2){let t,i=c();a(),b(" ",!((t=i.opportunityForm.get("accountId"))==null||t.errors==null)&&t.errors.required?"Please select a valid account owner.":""," ")}}function ee(o,e){if(o&1&&(r(0,"el-option",21)(1,"div",40)(2,"span",41),s(3),p()()()),o&2){let t=e.$implicit;m("id",J(t.contactId)),It("value",t.fullName),a(3),E(t.fullName)}}function ie(o,e){if(o&1&&(r(0,"div",10),s(1),p()),o&2){let t,i=c();a(),b(" ",!((t=i.opportunityForm.get("contactName"))==null||t.errors==null)&&t.errors.required?"Contact name is required.":""," ")}}function oe(o,e){if(o&1&&(r(0,"div",10),s(1),p()),o&2){let t,i=c();a(),b(" ",!((t=i.opportunityForm.get("contactId"))==null||t.errors==null)&&t.errors.required?"Please select a valid contact.":""," ")}}function ne(o,e){if(o&1&&(r(0,"option",27),s(1),p()),o&2){let t=e.$implicit;m("value",J(t.stageId)),a(),E(t.name)}}function re(o,e){if(o&1&&(r(0,"div",10),s(1),p()),o&2){let t,i=c();a(),b(" ",!((t=i.opportunityForm.get("stageId"))==null||t.errors==null)&&t.errors.required?"Opportunity stage is required.":""," ")}}function ae(o,e){if(o&1&&(r(0,"option",27),s(1),p()),o&2){let t=e.$implicit;m("value",J(t)),a(),E(t)}}function pe(o,e){if(o&1&&(r(0,"div",10),s(1),p()),o&2){let t,i=c();a(),b(" ",!((t=i.opportunityForm.get("status"))==null||t.errors==null)&&t.errors.required?"Status is required.":""," ")}}function se(o,e){o&1&&(r(0,"div",10),s(1),p()),o&2&&(a(),b(" ","Expected close date is required."," "))}function le(o,e){o&1&&(r(0,"div",10),s(1),p()),o&2&&(a(),b(" ","Closed date is required."," "))}function ue(o,e){o&1&&(r(0,"div",10),s(1),p()),o&2&&(a(),b(" ","Please enter a valid note."," "))}var K=class o{userService=y(xt);contactsService=y(Gt);accountService=y(qt);opportunitiesService=y(M);fb=y(mt);opportunityId=null;isEditMode=!1;formTitle="Create Opportunity";formSubmit=new N;resetFormEvent=!1;userList=[];accountList=[];contactList=[];opportunityStages=[];opportunityStatuses=Object.values(X);opportunityForm=this.fb.group({opportunityId:[""],accountName:[""],accountId:[""],contactName:[""],contactId:[""],opportunityName:[""],stageId:[""],status:["Active"],closedDate:[""],expectedCloseDate:[""],notes:[""],opportunityOwnerId:[""],opportunityOwnerName:[""]});ngOnInit(){this.loadUserList(),this.loadAccountList(),this.loadOpportunityStages(),this.opportunityForm.get("accountId")?.valueChanges.subscribe(e=>{e?this.loadAccountContacts(e):this.contactList=[]})}ngOnChanges(e){e.opportunityId&&(this.opportunityId&&this.populateForm(this.opportunityId),this.loadUserList(),this.loadAccountList()),e.resetFormEvent&&this.resetFormEvent&&(this.opportunityForm.reset(),this.isEditMode=!1,this.formTitle="Create Opportunity")}populateForm(e){this.opportunitiesService.getOpportunityById(e,!0).subscribe(t=>{this.opportunityForm.patchValue({opportunityId:t.opportunityId,opportunityName:t.opportunityName,accountId:t.accountId,accountName:t.account?.companyName,contactId:t.contactId,contactName:t.contact?.fullName,stageId:t.stageId,status:t.status,closedDate:t.closedDate?this.formatDateForInput(t.closedDate):null,expectedCloseDate:t.expectedCloseDate?this.formatDateForInput(t.expectedCloseDate):null,notes:t.notes,opportunityOwnerId:t.opportunityOwnerId||"",opportunityOwnerName:t.opportunityOwner?.fullName||""})})}loadUserList(e=""){let t=e?e.trim():"";this.userService.getUsers(t,20,0).subscribe(l=>{this.userList=l.data})}loadAccountList(e=""){let t=e?e.trim():"";this.accountService.searchAccountsForAutocomplete(t,20).subscribe(n=>{this.accountList=n})}loadOpportunityStages(){this.opportunitiesService.getOpportunityStages().subscribe(e=>{this.opportunityStages=e})}loadAccountContacts(e,t=""){this.contactsService.searchContactsForAutocomplete(t,20,e).subscribe(i=>{this.contactList=i})}onSubmit(){if(this.opportunityForm.markAllAsTouched(),this.opportunityForm.valid){let e=this.opportunityForm.value;this.formSubmit.emit(e)}}closeForm(){this.formSubmit.emit(null),this.resetForm()}resetForm(){this.opportunityForm.reset(),this.opportunityId=null,this.isEditMode=!1,this.formTitle="Create Opportunity"}formatDateForInput(e){return new Date(e).toISOString().slice(0,16)}static \u0275fac=function(t){return new(t||o)};static \u0275cmp=k({type:o,selectors:[["app-opportunity-form"]],inputs:{opportunityId:"opportunityId",isEditMode:"isEditMode",formTitle:"formTitle",resetFormEvent:"resetFormEvent"},outputs:{formSubmit:"formSubmit"},features:[Q],decls:94,vars:15,consts:[[1,"space-y-8","dark:divide-white/10",3,"ngSubmit","formGroup"],[1,"dark:border-white/10"],[1,"text-base/7","font-semibold","text-gray-900","dark:text-white"],[1,"mt-1","text-sm/6","text-gray-600","dark:text-gray-400"],[1,"mt-10","grid","grid-cols-1","gap-x-6","gap-y-6","sm:grid-cols-6"],[1,"sm:col-span-4"],["for","opportunityName",1,"block","text-sm/6","font-medium","text-gray-900","dark:text-white"],[1,"text-red-500"],[1,"mt-2"],["id","opportunityName","type","text","name","opportunityName","formControlName","opportunityName","autocomplete","name","placeholder","Enter opportunity name",1,"block","w-full","rounded-md","bg-white","px-3","py-1","text-base","text-gray-900","outline-1","-outline-offset-1","outline-gray-300","placeholder:text-gray-400","focus:outline-2","focus:-outline-offset-2","focus:outline-primary-600","sm:text-sm/6","dark:bg-white/5","dark:text-white","dark:outline-white/10","dark:placeholder:text-gray-500","dark:focus:outline-primary-500"],[1,"mt-1","text-xs","text-red-500"],[1,"sm:col-span-2"],["for","opportunityOwnerName",1,"block","text-sm/6","font-medium","text-gray-900","dark:text-white"],["formControlName","opportunityOwnerId","size","sm","placeholder","Select Owner",3,"options"],["for","accountName",1,"block","text-sm/6","font-medium","text-gray-900","dark:text-white"],["id","account","appAutocomplete","","nameControl","accountName","idControl","accountId",1,"relative","mt-2","block",3,"targetForm"],["id","combobox","type","text","formControlName","accountName","placeholder","Type account name",1,"block","w-full","rounded-md","bg-white","py-1","pr-12","pl-3","text-base","text-gray-900","outline-1","-outline-offset-1","outline-gray-300","placeholder:text-gray-400","focus:outline-2","focus:-outline-offset-2","focus:outline-primary-500","sm:text-sm/6","dark:bg-white/5","dark:text-white","dark:outline-white/10","dark:placeholder:text-gray-500","dark:focus:outline-primary-500",3,"change"],["type","button",1,"absolute","inset-y-0","right-0","flex","items-center","rounded-r-md","px-2","focus:outline-hidden"],["viewBox","0 0 20 20","fill","currentColor","data-slot","icon","aria-hidden","true",1,"size-5","text-gray-400"],["d","M5.22 8.22a.75.75 0 0 1 1.06 0L10 11.94l3.72-3.72a.75.75 0 1 1 1.06 1.06l-4.25 4.25a.75.75 0 0 1-1.06 0L5.22 9.28a.75.75 0 0 1 0-1.06Z","clip-rule","evenodd","fill-rule","evenodd"],["anchor","bottom end","popover","",1,"max-h-60","w-(--input-width)","overflow-auto","rounded-md","bg-white","py-1","text-base","shadow-lg","outline","outline-black/5","transition-discrete","[--anchor-gap:--spacing(1)]","data-leave:transition","data-leave:duration-100","data-leave:ease-in","data-closed:data-leave:opacity-0","sm:text-sm","dark:bg-gray-800","dark:shadow-none","dark:-outline-offset-1","dark:outline-white/10"],[1,"block","px-3","py-1.5","text-gray-900","select-none","aria-selected:bg-primary-500","aria-selected:text-white","dark:text-white","dark:aria-selected:bg-primary-500",3,"id"],["for","contactName",1,"block","text-sm/6","font-medium","text-gray-900","dark:text-white"],["id","account","appAutocomplete","","nameControl","contactName","idControl","contactId",1,"relative","mt-2","block",3,"targetForm"],["id","combobox","type","text","formControlName","contactName","placeholder","Type contact name",1,"block","w-full","rounded-md","bg-white","py-1","pr-12","pl-3","text-base","text-gray-900","outline-1","-outline-offset-1","outline-gray-300","placeholder:text-gray-400","focus:outline-2","focus:-outline-offset-2","focus:outline-primary-500","sm:text-sm/6","dark:bg-white/5","dark:text-white","dark:outline-white/10","dark:placeholder:text-gray-500","dark:focus:outline-primary-500",3,"change"],["for","opportunityStage",1,"block","text-sm/6","font-medium","text-gray-900","dark:text-white"],["id","opportunityStage","name","opportunityStage","formControlName","stageId",1,"block","w-full","rounded-md","bg-white","py-1.5","pr-8","pl-3","text-base","text-gray-900","outline-1","-outline-offset-1","outline-gray-300","focus:outline-2","focus:-outline-offset-2","focus:outline-primary-500","sm:text-sm/6","dark:bg-white/5","dark:text-white","dark:outline-white/10","dark:*:bg-gray-800","dark:focus:outline-primary-500"],[3,"value"],["for","status",1,"block","text-sm/6","font-medium","text-gray-900","dark:text-white"],["id","status","name","status","formControlName","status",1,"block","w-full","rounded-md","bg-white","py-1.5","pr-8","pl-3","text-base","text-gray-900","outline-1","-outline-offset-1","outline-gray-300","focus:outline-2","focus:-outline-offset-2","focus:outline-primary-500","sm:text-sm/6","dark:bg-white/5","dark:text-white","dark:outline-white/10","dark:*:bg-gray-800","dark:focus:outline-primary-500"],["for","expectedCloseDate",1,"block","text-sm/6","font-medium","text-gray-900","dark:text-white"],["id","expectedCloseDate","type","datetime-local","name","expectedCloseDate","formControlName","expectedCloseDate",1,"block","w-full","rounded-md","bg-white","px-3","py-1","text-base","text-gray-900","outline-1","-outline-offset-1","outline-gray-300","placeholder:text-gray-400","focus:outline-2","focus:-outline-offset-2","focus:outline-primary-600","sm:text-sm/6","dark:bg-white/5","dark:text-white","dark:outline-white/10","dark:placeholder:text-gray-500","dark:focus:outline-primary-500"],["for","closedDate",1,"block","text-sm/6","font-medium","text-gray-900","dark:text-white"],["id","closedDate","type","datetime-local","name","closedDate","formControlName","closedDate",1,"block","w-full","rounded-md","bg-white","px-3","py-1","text-base","text-gray-900","outline-1","-outline-offset-1","outline-gray-300","placeholder:text-gray-400","focus:outline-2","focus:-outline-offset-2","focus:outline-primary-600","sm:text-sm/6","dark:bg-white/5","dark:text-white","dark:outline-white/10","dark:placeholder:text-gray-500","dark:focus:outline-primary-500"],[1,"sm:col-span-6"],["for","notes",1,"block","text-sm/6","font-medium","text-gray-900","dark:text-white"],["id","notes","name","notes","formControlName","notes","autocomplete","off","placeholder","Enter notes",1,"block","w-full","rounded-md","bg-white","px-3","py-1","text-base","text-gray-900","outline-1","-outline-offset-1","outline-gray-300","placeholder:text-gray-400","focus:outline-2","focus:-outline-offset-2","focus:outline-primary-600","sm:text-sm/6","dark:bg-white/5","dark:text-white","dark:outline-white/10","dark:placeholder:text-gray-500","dark:focus:outline-primary-500"],[1,"mt-6","flex","items-center","justify-end","gap-x-6"],["type","button",1,"text-sm/6","font-semibold","text-gray-900","dark:text-white",3,"click"],["type","submit",1,"rounded-md","bg-primary-500","px-3","py-2","text-sm","font-semibold","text-white","shadow-xs","hover:bg-primary-500/80","focus-visible:outline-2","focus-visible:outline-offset-2","focus-visible:outline-primary-600","dark:bg-primary-500","dark:shadow-none","dark:focus-visible:outline-primary-500"],[1,"flex"],[1,"truncate"]],template:function(t,i){if(t&1&&(r(0,"form",0),S("ngSubmit",function(){return i.onSubmit()}),r(1,"div",1)(2,"h2",2),s(3,"Opportunity Information"),p(),r(4,"p",3),s(5,"Information about the opportunity. "),p(),r(6,"div",4)(7,"div",5)(8,"label",6),s(9," Opportunity Name "),r(10,"span",7),s(11,"*"),p()(),r(12,"div",8),v(13,"input",9),g(14,Yt,2,1,"div",10),p()(),r(15,"div",11)(16,"label",12),s(17,"Opportunity Owner "),r(18,"span",7),s(19,"*"),p()(),r(20,"div",8),v(21,"app-user-selection-input",13),g(22,Kt,2,1,"div",10),p()(),r(23,"div",11)(24,"label",14),s(25,"Account (Company Name) "),r(26,"span",7),s(27,"*"),p()(),r(28,"div",8)(29,"el-autocomplete",15)(30,"input",16),S("change",function(){return i.loadAccountList()}),p(),r(31,"button",17),D(),r(32,"svg",18),v(33,"path",19),p()(),T(),r(34,"el-options",20),I(35,Jt,4,4,"el-option",21,V),p()(),g(37,Xt,2,1,"div",10),g(38,te,2,1,"div",10),p()(),r(39,"div",11)(40,"label",22),s(41,"Account Contact "),r(42,"span",7),s(43,"*"),p()(),r(44,"div",8)(45,"el-autocomplete",23)(46,"input",24),S("change",function(){return i.loadAccountList()}),p(),r(47,"button",17),D(),r(48,"svg",18),v(49,"path",19),p()(),T(),r(50,"el-options",20),I(51,ee,4,4,"el-option",21,V),p()(),g(53,ie,2,1,"div",10),g(54,oe,2,1,"div",10),p()(),r(55,"div",11)(56,"label",25),s(57,"Opportunity Stage "),p(),r(58,"div",8)(59,"select",26),I(60,ne,2,3,"option",27,V),p(),g(62,re,2,1,"div",10),p()(),r(63,"div",11)(64,"label",28),s(65,"Status "),p(),r(66,"div",8)(67,"select",29),I(68,ae,2,3,"option",27,V),p(),g(70,pe,2,1,"div",10),p()(),r(71,"div",11)(72,"label",30),s(73," Expected Close Date "),p(),r(74,"div",8),v(75,"input",31),g(76,se,2,1,"div",10),p()(),r(77,"div",11)(78,"label",32),s(79," Actual Close Date "),p(),r(80,"div",8),v(81,"input",33),g(82,le,2,1,"div",10),p()(),r(83,"div",34)(84,"label",35),s(85,"Notes"),p(),r(86,"div",8),v(87,"textarea",36),g(88,ue,2,1,"div",10),p()()()(),r(89,"div",37)(90,"button",38),S("click",function(){return i.closeForm()}),s(91,"Cancel"),p(),r(92,"button",39),s(93,"Save"),p()()()),t&2){let n,l,O,q,B,tt,et,it,G,z,ot;m("formGroup",i.opportunityForm),a(14),f((n=i.opportunityForm.get("opportunityName"))!=null&&n.touched&&((n=i.opportunityForm.get("opportunityName"))!=null&&n.invalid)?14:-1),a(7),m("options",i.userList),a(),f((l=i.opportunityForm.get("opportunityOwnerId"))!=null&&l.touched&&((l=i.opportunityForm.get("opportunityOwnerId"))!=null&&l.invalid)?22:-1),a(7),m("targetForm",i.opportunityForm),a(6),F(i.accountList),a(2),f((O=i.opportunityForm.get("accountName"))!=null&&O.touched&&((O=i.opportunityForm.get("accountName"))!=null&&O.invalid)?37:-1),a(),f((q=i.opportunityForm.get("accountId"))!=null&&q.touched&&((q=i.opportunityForm.get("accountId"))!=null&&q.invalid)?38:-1),a(7),m("targetForm",i.opportunityForm),a(6),F(i.contactList),a(2),f((B=i.opportunityForm.get("contactName"))!=null&&B.touched&&((B=i.opportunityForm.get("contactName"))!=null&&B.invalid)?53:-1),a(),f((tt=i.opportunityForm.get("contactId"))!=null&&tt.touched&&((tt=i.opportunityForm.get("contactId"))!=null&&tt.invalid)?54:-1),a(6),F(i.opportunityStages),a(2),f((et=i.opportunityForm.get("stageId"))!=null&&et.touched&&((et=i.opportunityForm.get("stageId"))!=null&&et.invalid)?62:-1),a(6),F(i.opportunityStatuses),a(2),f((it=i.opportunityForm.get("status"))!=null&&it.touched&&((it=i.opportunityForm.get("status"))!=null&&it.invalid)?70:-1),a(6),f(((G=i.opportunityForm.get("expectedCloseDate"))!=null&&G.touched||(G=i.opportunityForm.get("expectedCloseDate"))!=null&&G.dirty)&&((G=i.opportunityForm.get("expectedCloseDate"))!=null&&G.invalid)?76:-1),a(6),f(((z=i.opportunityForm.get("closedDate"))!=null&&z.touched||(z=i.opportunityForm.get("closedDate"))!=null&&z.dirty)&&((z=i.opportunityForm.get("closedDate"))!=null&&z.invalid)?82:-1),a(6),f((ot=i.opportunityForm.get("notes"))!=null&&ot.touched&&((ot=i.opportunityForm.get("notes"))!=null&&ot.invalid)?88:-1)}},dependencies:[yt,ut,Bt,Rt,pt,Vt,st,lt,dt,ct,$t,ht],encapsulation:2})};var de=["opportunityForm"],ce=()=>({multiSelect:!1,rowReferenceField:"opportunityId"}),vt=class o{opportunityForm;toastService=y(P);opportunitiesService=y(M);pageBreadcrumbs=[{label:"Home",path:"/"},{label:"Opportunities",path:"/opportunities/list"}];opportunities=[];columns=[{field:"opportunityId",label:"Opportunity ID",hidden:!0},{field:"opportunityName",label:"Opportunity Name",cellTemplate:"link",hrefField:"/opportunities/:opportunityId/view"},{field:"status",label:"Status",cellTemplate:"color-badge",colorBadgeMapper:{Active:"blue",Won:"green",Lost:"red"}},{field:"opportunityStage.name",label:"Opportunity Stage"},{field:"contact.fullName",label:"Contact Name"},{field:"createdAt",label:"Created Time",cellTemplate:"datetime"}];loading=!1;currentPage=1;pageSize=10;totalRecords=0;searchQuery="";eagerFetch=!0;opportunitystagOptions=[];filters=[{field:"stageId",label:"Opportunity Stage",value:null,type:"select",options:this.opportunitystagOptions},{field:"createdAt",label:"Created At",value:null,type:"date"}];filterData={filters:this.filters,config:{}};apiReadyFilterData=[];opportunitystages=[];selectedOpportunityIdToUpdate=$(null);tableRowActions=[{label:"View",actionCallback:e=>{}},{label:"Edit",actionCallback:e=>{this.selectedOpportunityIdToUpdate.set(e.opportunityId),this.openOpportunityFormModal()}}];ngOnInit(){this.loadOpportunityStages(),this.loadOpportunities()}loadOpportunityStages(){this.opportunitiesService.getOpportunityStages().subscribe(e=>{this.opportunitystages=e,this.opportunitystagOptions=e.map(t=>({label:t.name,value:t.stageId})),this.filters=this.filters.map(t=>t.field==="stageId"?Dt(Ft({},t),{options:this.opportunitystagOptions}):t),this.filterData={filters:this.filters,config:{}}})}loadOpportunities(){this.loading=!0;let e={field:"createdAt",order:"desc"};this.opportunitiesService.getOpportunities(this.searchQuery,this.apiReadyFilterData,e,this.currentPage,this.pageSize,this.eagerFetch).subscribe({next:t=>{let i=t.data||[];this.opportunities=Ut.mapDataToColumns(i,this.columns),this.totalRecords=t.total,this.loading=!1},error:t=>{console.error("Error fetching contacts:",t),this.loading=!1}})}onPageChangeHandler(e){this.currentPage=e,this.loadOpportunities()}onSearchChange(e){this.searchQuery=e,this.currentPage=1,this.loadOpportunities()}onFilterChange(e){if(!e||e.length===0){this.apiReadyFilterData=[],this.currentPage=1,this.loadOpportunities();return}let i=e.filter(n=>n.value).map(n=>{let l="contains";return n.type==="select"&&(l="equals"),n.type==="date"&&(l="equals"),n.type==="multiselect"&&(l="list"),{field:n.field,value:n.value,type:l}});this.apiReadyFilterData=i,this.currentPage=1,this.loadOpportunities()}resetFormEvent=$(!1);openOpportunityFormModal(){this.resetFormEvent.set(!1),this.opportunityForm.open()}closeOpportunityFormModal(){this.opportunityForm.close(),this.resetFormEvent.set(!0),this.selectedOpportunityIdToUpdate.set(null)}onOpportunityFormSubmit(e){if(console.log("Opportunity form submitted with data:",e),!e){this.closeOpportunityFormModal();return}e.opportunityId?this.updateOpportunity(e.opportunityId,e):this.createOpportunity(e)}createOpportunity(e){this.opportunitiesService.createOpportunity({accountId:e.accountId,contactId:e.contactId,opportunityName:e.opportunityName,opportunityOwnerId:e.opportunityOwnerId,stageId:e.stageId,status:e.status,closedDate:e.closedDate?new Date(e.closedDate).toISOString():null,expectedCloseDate:e.expectedCloseDate?new Date(e.expectedCloseDate).toISOString():null,notes:e.notes}).subscribe({next:t=>{t.opportunityId?(this.closeOpportunityFormModal(),this.toastService.success("Opportunity created successfully!"),this.resetFormEvent.set(!0),this.loadOpportunities()):this.toastService.error("Failed to create opportunity. Please try again.")},error:t=>{console.error("Error creating opportunity:",t)}})}updateOpportunity(e,t){this.opportunitiesService.updateOpportunity(e,{accountId:t.accountId,contactId:t.contactId,opportunityName:t.opportunityName,opportunityOwnerId:t.opportunityOwnerId,stageId:t.stageId,status:t.status,closedDate:t.closedDate?new Date(t.closedDate).toISOString():null,expectedCloseDate:t.expectedCloseDate?new Date(t.expectedCloseDate).toISOString():null,notes:t.notes}).subscribe({next:i=>{if(i.opportunityId){this.closeOpportunityFormModal(),this.toastService.success("Opportunity updated successfully!"),this.resetFormEvent.set(!0),this.loadOpportunities();return}else this.toastService.error("Failed to update opportunity. Please try again.")},error:i=>{console.error("Error updating opportunity:",i)}})}static \u0275fac=function(t){return new(t||o)};static \u0275cmp=k({type:o,selectors:[["app-opportunity-listing"]],viewQuery:function(t,i){if(t&1&&W(de,5),t&2){let n;Z(n=Y())&&(i.opportunityForm=n.first)}},decls:16,vars:14,consts:[["opportunityForm",""],[1,"px-4","sm:px-6","lg:px-8"],[1,"sm:flex","sm:items-center"],[1,"sm:flex-auto"],[1,""],["description","A list of all the opportunities in your system.",3,"title","breadcrumbs"],[1,"sm:mt-0","sm:ml-16","sm:flex-none"],["type","button",1,"block","rounded-md","bg-primary-500","px-3","py-2","text-center","text-sm","font-semibold","text-white","shadow-xs","hover:bg-primary-500/80","focus-visible:outline-2","focus-visible:outline-offset-2","focus-visible:outline-primary-500","dark:bg-primary-500","dark:hover:bg-indigo-400","dark:focus-visible:outline-primary-500",3,"click"],[3,"pageChange","search","filterChange","records","columns","currentPage","pageSize","totalRecords","filterData","rowActions","tableConfig"],[3,"closeModal","modalId"],[1,"mt-3","text-center","sm:mt-0","sm:text-left"],[1,"mt-2"],[1,"mt-4"],[3,"formSubmit","opportunityId","resetFormEvent"],[1,"mt-5","sm:mt-4","sm:flex","sm:flex-row-reverse"]],template:function(t,i){if(t&1){let n=A();r(0,"div",1)(1,"div",2)(2,"div",3)(3,"div",4),v(4,"app-page-heading",5),p()(),r(5,"div",6)(6,"button",7),S("click",function(){return h(n),x(i.openOpportunityFormModal())}),s(7,"Add opportunity"),p()()(),r(8,"app-custom-datatable",8),S("pageChange",function(O){return h(n),x(i.onPageChangeHandler(O))})("search",function(O){return h(n),x(i.onSearchChange(O))})("filterChange",function(O){return h(n),x(i.onFilterChange(O))}),p()(),r(9,"app-modal-medium",9,0),S("closeModal",function(){return h(n),x(i.closeOpportunityFormModal())}),r(11,"div",10),v(12,"div",11),r(13,"div",12)(14,"app-opportunity-form",13),S("formSubmit",function(O){return h(n),x(i.onOpportunityFormSubmit(O))}),p()()(),v(15,"div",14),p()}t&2&&(a(4),m("title","Opportunities")("breadcrumbs",i.pageBreadcrumbs),a(4),m("records",i.opportunities)("columns",i.columns)("currentPage",i.currentPage)("pageSize",i.pageSize)("totalRecords",i.totalRecords)("filterData",i.filterData)("rowActions",i.tableRowActions)("tableConfig",Mt(13,ce)),a(),m("modalId","opportunity-form-modal"),a(5),m("opportunityId",i.selectedOpportunityIdToUpdate())("resetFormEvent",i.resetFormEvent()))},dependencies:[gt,jt,ft,K],encapsulation:2})};var bt=class o{api=y(rt);toastService=y(P);errorHandler=y(at);http=y(Pt);baseUrl=this.api.config?.apiUrl||"";getDocumentsByOpportunityId(e){return this.api.get(`opportunity-documents/by-opportunity/${e}`).pipe(C(t=>(this.errorHandler.handleError(t),w([]))),_(t=>t.data||[]))}getDocumentById(e){return this.api.get(`opportunity-documents/${e}`).pipe(C(t=>(this.errorHandler.handleError(t),w({}))),_(t=>t.data))}createDocument(e){return this.api.post("opportunity-documents/create",e).pipe(C(t=>(this.errorHandler.handleError(t),w({}))),_(t=>t.data))}updateDocument(e,t){return this.api.put(`opportunity-documents/${e}/update`,t).pipe(C(i=>(this.errorHandler.handleError(i),w({}))),_(i=>i.data))}downloadDocument(e){try{return this.api.getBlob(`opportunity-documents/${e}/download`)}catch{return this.http.get(`/api/opportunity-documents/${e}/download`,{responseType:"blob"})}}deleteDocument(e){return this.api.delete(`opportunity-documents/${e}`).pipe(C(t=>(this.errorHandler.handleError(t),w(!1))),_(t=>(this.toastService.success("Document deleted successfully"),!0)))}static \u0275fac=function(t){return new(t||o)};static \u0275prov=nt({token:o,factory:o.\u0275fac,providedIn:"root"})};var ye=(o,e)=>e.documentId;function ge(o,e){o&1&&(u(0,"div"),s(1,"Loading documents..."),d())}function fe(o,e){if(o&1&&(u(0,"div",0),s(1),d()),o&2){let t=c();a(),E(t.error)}}function he(o,e){o&1&&(u(0,"div",10),s(1,"No documents found."),d())}function xe(o,e){if(o&1){let t=A();u(0,"tr")(1,"td",13)(2,"div",14)(3,"button",15),j("click",function(n){let l=h(t).$implicit;return c(3).downloadDocument(l),x(n.preventDefault())}),s(4),d(),u(5,"button",16),j("click",function(n){let l=h(t).$implicit;return c(3).onDelete(l),x(n.preventDefault())}),u(6,"span"),s(7," Delete"),d()()()()()}if(o&2){let t=e.$implicit;a(4),b(" ",t.documentName," ")}}function ve(o,e){if(o&1&&(u(0,"table",11)(1,"thead")(2,"tr")(3,"th",12),s(4," Document"),d()()(),u(5,"tbody"),I(6,xe,8,1,"tr",null,ye),d()()),o&2){let t=c(2);a(6),F(t.documents)}}function be(o,e){if(o&1){let t=A();u(0,"div",1)(1,"div",2)(2,"div",3)(3,"h1",4),s(4,"Documents"),d(),u(5,"p",5),s(6,"All documents related to the opportunity."),d()(),u(7,"div",6)(8,"label",7),s(9," Add Document "),u(10,"input",8),j("change",function(n){h(t);let l=c();return x(l.onFileSelected(n))}),d()()()(),u(11,"div",9),g(12,he,2,0,"div",10)(13,ve,8,0,"table",11),d()()}if(o&2){let t=c();a(12),f(t.documents.length===0?12:13)}}var Ot=class o{constructor(e){this.docService=e}opportunityId;documents=[];loading=!1;error=null;ngOnInit(){this.opportunityId&&this.fetchDocuments()}fetchDocuments(){this.loading=!0,this.docService.getDocumentsByOpportunityId(this.opportunityId).subscribe({next:e=>{this.documents=e,this.loading=!1},error:e=>{this.error="Failed to load documents.",this.loading=!1}})}onFileSelected(e){let t=e.target.files[0];if(!t)return;let i=new FormData;i.append("opportunityId",this.opportunityId),i.append("documentType","Other"),i.append("file",t),this.docService.createDocument(i).subscribe({next:()=>this.fetchDocuments(),error:()=>this.error="Failed to upload document."})}downloadDocument(e){this.docService.downloadDocument(e.documentId).subscribe({next:t=>{let i=window.URL.createObjectURL(t),n=document.createElement("a");n.href=i,n.download=e.documentName||"document",document.body.appendChild(n),n.click(),setTimeout(()=>{window.URL.revokeObjectURL(i),document.body.removeChild(n)},100)},error:()=>{this.error="Failed to download document."}})}onDelete(e){confirm(`Delete document "${e.documentName}"? This action cannot be undone.`)&&this.docService.deleteDocument(e.documentId).subscribe({next:t=>{t?this.fetchDocuments():this.error="Failed to delete document."},error:()=>{this.error="Failed to delete document."}})}static \u0275fac=function(t){return new(t||o)(Tt(bt))};static \u0275cmp=k({type:o,selectors:[["app-opportunity-documents"]],inputs:{opportunityId:"opportunityId"},decls:3,vars:3,consts:[[1,"text-red-500"],[1,"px-4","sm:px-6","lg:px-8"],[1,"sm:flex","sm:items-center"],[1,"sm:flex-auto"],[1,"text-base","font-semibold","text-gray-900","dark:text-white"],[1,"mt-2","text-sm","text-gray-700","dark:text-gray-300"],[1,"mt-4","sm:mt-0","sm:ml-16","sm:flex-none"],[1,"inline-block","cursor-pointer","rounded-md","bg-primary-600","px-3","py-1.5","text-center","text-sm","font-semibold","text-white","shadow-xs","hover:bg-primary-600/80"],["type","file",1,"hidden",3,"change"],[1,"-mx-4","mt-10","ring-1","ring-gray-300","sm:mx-0","sm:rounded-lg","dark:ring-white/15"],[1,"p-4","text-gray-500","dark:text-gray-400"],[1,"relative","min-w-full","divide-y","divide-gray-300","dark:divide-white/15"],["scope","col",1,"py-3.5","pr-3","pl-4","text-left","text-sm","font-semibold","text-gray-900","sm:pl-6","dark:text-white"],[1,"hidden","px-3","py-3.5","text-sm","text-gray-500","lg:table-cell","dark:text-gray-400"],[1,"flex","justify-between"],[1,"hover:text-primary-600","hover:underline","mr-3",3,"click"],["type","button",1,"inline-flex","items-center","rounded-md","bg-white","px-2.5","py-1.5","text-xs","font-semibold","text-red-600","shadow-xs","inset-ring","inset-ring-gray-300","hover:bg-gray-50","disabled:cursor-not-allowed","disabled:opacity-30","disabled:hover:bg-white","dark:bg-white/10","dark:text-white","dark:inset-ring-white/10","dark:hover:bg-white/15","dark:disabled:hover:bg-white/10",3,"click"]],template:function(t,i){t&1&&(g(0,ge,2,0,"div"),g(1,fe,2,1,"div",0),g(2,be,14,1,"div",1)),t&2&&(f(i.loading?0:-1),a(),f(i.error?1:-1),a(),f(!i.loading&&!i.error?2:-1))},styles:[".table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{border:1px solid #e5e7eb;padding:.5rem}.text-red-500[_ngcontent-%COMP%]{color:#ef4444}.bg-primary-500[_ngcontent-%COMP%]{background:#3b82f6}"]})};var _t=class o{cancelAction=new N;confirmAction=new N;message="Are you sure you want to proceed?";title="Please Confirm";confirmButtonText="Confirm";cancelButtonText="Cancel";ngOnDestroy(){this.triggerElement&&(document.body.removeChild(this.triggerElement),this.triggerElement=null)}triggerElement=null;modalId="confirmation-dialog";open(){this.triggerElement=document.createElement("button"),this.triggerElement.setAttribute("command","show-modal"),this.triggerElement.setAttribute("commandfor",this.modalId),document.body.appendChild(this.triggerElement),this.triggerElement.click()}close(){this.triggerElement&&(this.triggerElement.setAttribute("command","close"),this.triggerElement.click(),document.body.removeChild(this.triggerElement),this.triggerElement=null)}onConfirm(){this.confirmAction.emit(),this.close()}onCancel(){this.cancelAction.emit(),this.close()}static \u0275fac=function(t){return new(t||o)};static \u0275cmp=k({type:o,selectors:[["app-confirmation-box"]],inputs:{message:"message",title:"title",confirmButtonText:"confirmButtonText",cancelButtonText:"cancelButtonText"},outputs:{cancelAction:"cancelAction",confirmAction:"confirmAction"},decls:20,vars:4,consts:[["id","confirmation-dialog","aria-labelledby","confirmation-dialog-title",1,"fixed","inset-0","size-auto","max-h-none","max-w-none","overflow-y-auto","bg-transparent","backdrop:bg-transparent"],[1,"fixed","inset-0","bg-gray-500/75","transition-opacity","data-closed:opacity-0","data-enter:duration-300","data-enter:ease-out","data-leave:duration-200","data-leave:ease-in","dark:bg-gray-900/50"],["tabindex","0",1,"flex","min-h-full","items-end","justify-center","p-4","text-center","focus:outline-none","sm:items-center","sm:p-0"],[1,"relative","transform","overflow-hidden","rounded-lg","bg-white","px-4","pt-5","pb-4","text-left","shadow-xl","transition-all","data-closed:translate-y-4","data-closed:opacity-0","data-enter:duration-300","data-enter:ease-out","data-leave:duration-200","data-leave:ease-in","sm:my-8","sm:w-full","sm:max-w-lg","sm:p-6","data-closed:sm:translate-y-0","data-closed:sm:scale-95","dark:bg-gray-800","dark:outline","dark:-outline-offset-1","dark:outline-white/10"],[1,"sm:flex","sm:items-start"],[1,"mx-auto","flex","size-12","shrink-0","items-center","justify-center","rounded-full","bg-primary-500/10","sm:mx-0","sm:size-10","dark:bg-primary-500/10"],["viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","1.5","data-slot","icon","aria-hidden","true",1,"size-6","text-primary-600","dark:text-primary-400"],["d","M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z","stroke-linecap","round","stroke-linejoin","round"],[1,"mt-3","text-center","sm:mt-0","sm:ml-4","sm:text-left"],["id","confirmation-dialog-title",1,"text-base","font-semibold","text-gray-900","dark:text-white"],[1,"mt-2"],[1,"text-sm","text-gray-500","dark:text-gray-400"],[1,"mt-5","sm:mt-4","sm:flex","sm:flex-row-reverse"],[1,"inline-flex","w-full","justify-center","rounded-md","bg-primary-600","px-3","py-2","text-sm","font-semibold","text-white","shadow-xs","hover:bg-primary-500/80","sm:ml-3","sm:w-auto","dark:bg-primary-500","dark:shadow-none","dark:hover:bg-primary-400",3,"click"],[1,"mt-3","inline-flex","w-full","justify-center","rounded-md","bg-white","px-3","py-2","text-sm","font-semibold","text-gray-900","shadow-xs","inset-ring-1","inset-ring-gray-300","hover:bg-gray-50","sm:mt-0","sm:w-auto","dark:bg-white/10","dark:text-white","dark:shadow-none","dark:inset-ring-white/5","dark:hover:bg-white/20",3,"click"]],template:function(t,i){t&1&&(u(0,"el-dialog")(1,"dialog",0),R(2,"el-dialog-backdrop",1),u(3,"div",2)(4,"el-dialog-panel",3)(5,"div",4)(6,"div",5),D(),u(7,"svg",6),R(8,"path",7),d()(),T(),u(9,"div",8)(10,"h3",9),s(11),d(),u(12,"div",10)(13,"p",11),s(14),d()()()(),u(15,"div",12)(16,"button",13),j("click",function(){return i.onConfirm()}),s(17),d(),u(18,"button",14),j("click",function(){return i.onCancel()}),s(19),d()()()()()()),t&2&&(a(11),E(i.title),a(3),E(i.message),a(3),E(i.confirmButtonText),a(2),E(i.cancelButtonText))},encapsulation:2})};var Ct=class o{status="Active";get badgeClasses(){switch(this.status){case"Active":return"bg-blue-50 text-blue-700 inset-ring-blue-600/10 dark:bg-blue-400/10 dark:text-blue-400 dark:inset-ring-blue-400/20";case"Won":return"bg-green-50 text-green-700 inset-ring-green-600/10 dark:bg-green-400/10 dark:text-green-400 dark:inset-ring-green-400/20";case"Lost":return"bg-red-50 text-red-700 inset-ring-red-600/10 dark:bg-red-400/10 dark:text-red-400 dark:inset-ring-red-400/20";default:return"bg-gray-50 text-gray-700 inset-ring-gray-600/10 dark:bg-gray-400/10 dark:text-gray-400 dark:inset-ring-gray-400/20"}}get statusText(){return this.status}static \u0275fac=function(t){return new(t||o)};static \u0275cmp=k({type:o,selectors:[["app-status-badge"]],inputs:{status:"status"},decls:2,vars:3,consts:[[1,"inline-flex","items-center","rounded-full","px-2","py-1","text-xs","font-medium","inset-ring"]],template:function(t,i){t&1&&(u(0,"span",0),s(1),d()),t&2&&(At(i.badgeClasses),a(),b(" ",i.statusText,`
`))},encapsulation:2})};var Oe=["changeConfirmation"];function _e(o,e){if(o&1&&v(0,"app-status-badge",6),o&2){let t=c();m("status",t.opportunity.status)}}function Ce(o,e){if(o&1){let t=A();r(0,"button",22),S("click",function(){let n=h(t).$implicit;return x(n.handler())}),s(1),p()}if(o&2){let t=e.$implicit;a(),b(" ",t.label," ")}}var St=class o{changeConfirmationModal;fb=y(mt);userService=y(xt);opportunityService=y(M);toastService=y(P);opportunity=null;markAsLost=new N;markAsWon=new N;ownerChanged=new N;expectedCloseDateChanged=new N;userList=[];pendingChange=null;quickActions=[{label:"Close As Won",action:"close_won",handler:()=>{this.markAsWon.emit()}},{label:"Close As Lost",action:"close_lost",handler:()=>{this.markAsLost.emit()}}];confirmationTitle="Confirm Change";confirmationMessage="Are you sure you want to change?";headerForm=this.fb.group({ownerId:[""],ownerName:[""],stageId:[""],expectedCloseDate:[""]});ngOnChanges(){this.opportunity&&this.headerForm.patchValue({ownerId:this.opportunity.opportunityOwner?.id||"",ownerName:this.opportunity.opportunityOwner?.fullName||"",expectedCloseDate:this.opportunity.expectedCloseDate?new Date(this.opportunity.expectedCloseDate).toISOString().substring(0,10):""})}ngOnInit(){this.setupFormChangeListeners(),this.loadUserList()}ngAfterViewInit(){}setupFormChangeListeners(){this.headerForm.get("expectedCloseDate")?.valueChanges.subscribe(e=>{this.opportunity&&e!==this.getOriginalFieldValue("expectedCloseDate")&&this.requestFieldChangeConfirmation("expectedCloseDate",this.getOriginalFieldValue("expectedCloseDate"),e)}),this.headerForm.get("ownerId")?.valueChanges.subscribe(e=>{this.opportunity&&e!==this.getOriginalFieldValue("ownerId")&&this.requestFieldChangeConfirmation("ownerId",this.getOriginalFieldValue("ownerId"),e)})}getOriginalFieldValue(e){if(!this.opportunity)return null;switch(e){case"expectedCloseDate":return this.opportunity.expectedCloseDate?new Date(this.opportunity.expectedCloseDate).toISOString().substring(0,10):"";case"ownerName":return this.opportunity.opportunityOwner?.fullName||"";case"ownerId":return this.opportunity?.opportunityOwner?.id||"";default:return null}}requestFieldChangeConfirmation(e,t,i){switch(this.pendingChange={field:e,oldValue:t,newValue:i},e){case"expectedCloseDate":this.confirmationTitle="Confirm Change",this.confirmationMessage="Are you sure you want to change the expected close date?";break;case"ownerId":this.confirmationTitle="Change Opportunity Owner",this.confirmationMessage="Are you sure you want to change the opportunity owner?";break;default:this.confirmationTitle="Confirm Change",this.confirmationMessage="Are you sure you want to make this change?"}this.changeConfirmationModal.open()}loadUserList(e=""){this.userService.getUsers(e,5,0).subscribe(t=>{this.userList=t.data})}onChangeConfirmed(){if(this.pendingChange){switch(console.log(`${this.pendingChange.field} change confirmed`),this.pendingChange.field){case"expectedCloseDate":this.updateExpectedCloseDate();break;case"ownerId":this.updateOwner();break}this.pendingChange=null}}onChangeCancelled(){this.pendingChange&&(console.log(`${this.pendingChange.field} change cancelled`),this.headerForm.patchValue({[this.pendingChange.field]:this.pendingChange.oldValue},{emitEvent:!1}),this.pendingChange=null)}onOwnerSelected(e){this.headerForm.patchValue({ownerId:e.id,ownerName:e.fullName})}updateExpectedCloseDate(){if(!this.opportunity||!this.headerForm.value.expectedCloseDate)return;let e=this.headerForm.value.expectedCloseDate,t=new Date(e+"T00:00:00Z").toISOString(),i={opportunityId:this.opportunity.opportunityId||"",expectedCloseDate:t};this.opportunityService.updateOpportunity(this.opportunity.opportunityId,i).subscribe({next:n=>{if(n.opportunityId){this.toastService.success("Opportunity updated successfully!"),this.opportunity=n;return}this.toastService.error("Failed to update opportunity.")},error:n=>{console.error("Error updating expected close date:",n),this.headerForm.patchValue({expectedCloseDate:this.opportunity?.expectedCloseDate?new Date(this.opportunity.expectedCloseDate).toISOString().substring(0,10):""},{emitEvent:!1})}})}updateOwner(){if(!this.opportunity)return;let t={opportunityOwnerId:this.headerForm.value.ownerId||void 0};console.log("Updating opportunity owner:",t),this.opportunityService.updateOpportunity(this.opportunity.opportunityId,t).subscribe({next:i=>{console.log("Opportunity owner updated successfully:",i),this.opportunity=i},error:i=>{console.error("Error updating opportunity owner:",i),this.headerForm.patchValue({ownerId:this.opportunity?.opportunityOwner?.id||"",ownerName:this.opportunity?.opportunityOwner?.fullName||""},{emitEvent:!1})}})}static \u0275fac=function(t){return new(t||o)};static \u0275cmp=k({type:o,selectors:[["app-opportunity-header-box"]],viewQuery:function(t,i){if(t&1&&W(Oe,5),t&2){let n;Z(n=Y())&&(i.changeConfirmationModal=n.first)}},inputs:{opportunity:"opportunity"},outputs:{markAsLost:"markAsLost",markAsWon:"markAsWon",ownerChanged:"ownerChanged",expectedCloseDateChanged:"expectedCloseDateChanged"},features:[Q],decls:32,vars:7,consts:[["changeConfirmation",""],[3,"formGroup"],[1,"grid","grid-cols-1","gap-4","sm:grid-cols-2","md:grid-cols-3","lg:grid-cols-3","items-center","justify-between"],[1,"sm:flex-1"],[1,"flex","items-center","gap-3"],[1,"text-base","font-semibold","text-gray-900","dark:text-white"],[3,"status"],[1,"mt-1","truncate","text-sm","text-gray-500","dark:text-gray-400"],[1,"inline-block"],[1,"inline-flex","w-full","justify-center","gap-x-1.5","rounded-md","bg-white","px-3","py-2","text-sm","font-semibold","text-gray-900","shadow-xs","inset-ring-1","inset-ring-gray-300","hover:bg-gray-50","dark:bg-white/10","dark:text-white","dark:shadow-none","dark:inset-ring-white/5","dark:hover:bg-white/20"],["viewBox","0 0 20 20","fill","currentColor","data-slot","icon","aria-hidden","true",1,"-mr-1","size-5","text-gray-400"],["d","M5.22 8.22a.75.75 0 0 1 1.06 0L10 11.94l3.72-3.72a.75.75 0 1 1 1.06 1.06l-4.25 4.25a.75.75 0 0 1-1.06 0L5.22 9.28a.75.75 0 0 1 0-1.06Z","clip-rule","evenodd","fill-rule","evenodd"],["anchor","bottom end","popover","",1,"w-56","origin-top-right","rounded-md","bg-white","shadow-lg","outline-1","outline-black/5","transition","transition-discrete","[--anchor-gap:--spacing(2)]","data-closed:scale-95","data-closed:transform","data-closed:opacity-0","data-enter:duration-100","data-enter:ease-out","data-leave:duration-75","data-leave:ease-in","dark:bg-gray-800","dark:shadow-none","dark:-outline-offset-1","dark:outline-white/10"],[1,"py-1"],["type","button",1,"block","w-full","px-4","py-2","text-left","text-sm","text-gray-700","focus:bg-gray-100","focus:text-gray-900","focus:outline-hidden","dark:text-gray-300","dark:focus:bg-white/5","dark:focus:text-white"],[1,"flex","justify-center"],[1,"mr-6"],[1,"text-sm","font-medium","text-gray-500","dark:text-gray-400"],["type","date","formControlName","expectedCloseDate",1,"w-52","mt-1","rounded-md","bg-white","py-0.5","pr-2","pl-3","text-base","text-gray-900","outline-1","-outline-offset-1","outline-gray-300","placeholder:text-gray-400","focus:outline-2","focus:-outline-offset-2","focus:outline-primary-500","sm:text-sm/6","dark:bg-white/5","dark:text-white","dark:outline-white/10","dark:placeholder:text-gray-500","dark:focus:outline-primary-500"],[1,"mt-1"],["formControlName","ownerId","size","xs","placeholder","Select user",3,"inputChange","optionSelected","options"],["confirmButtonText","Yes, Change","cancelButtonText","Cancel",3,"confirmAction","cancelAction","title","message"],["type","button",1,"block","w-full","px-4","py-2","text-left","text-sm","text-gray-700","focus:bg-gray-100","focus:text-gray-900","focus:outline-hidden","dark:text-gray-300","dark:focus:bg-white/5","dark:focus:text-white",3,"click"]],template:function(t,i){if(t&1){let n=A();r(0,"form",1)(1,"div",2)(2,"div",3)(3,"div",4)(4,"h1",5),s(5),p(),g(6,_e,1,1,"app-status-badge",6),p(),r(7,"p",7),s(8),p()(),r(9,"div")(10,"el-dropdown",8)(11,"button",9),s(12," Quick Actions "),D(),r(13,"svg",10),v(14,"path",11),p()(),T(),r(15,"el-menu",12)(16,"div",13),I(17,Ce,2,1,"button",14,V),p()()()(),r(19,"div",15)(20,"div",16)(21,"h2",17),s(22,"Expected Close Date"),p(),r(23,"div"),v(24,"input",18),p()(),r(25,"div")(26,"h2",17),s(27,"Owner"),p(),r(28,"div",19)(29,"app-user-selection-input",20),S("inputChange",function(O){return h(n),x(i.loadUserList(O))})("optionSelected",function(O){return h(n),x(i.onOwnerSelected(O))}),p()()()()()(),r(30,"app-confirmation-box",21,0),S("confirmAction",function(){return h(n),x(i.onChangeConfirmed())})("cancelAction",function(){return h(n),x(i.onChangeCancelled())}),p()}t&2&&(m("formGroup",i.headerForm),a(5),E(i.opportunity==null?null:i.opportunity.opportunityName),a(),f(i.opportunity!=null&&i.opportunity.status?6:-1),a(2),E("Account: "+(i.opportunity==null||i.opportunity.account==null?null:i.opportunity.account.companyName)),a(9),F(i.quickActions),a(12),m("options",i.userList),a(),m("title",i.confirmationTitle)("message",i.confirmationMessage))},dependencies:[H,_t,Ht,ut,pt,st,lt,yt,dt,ct,Ct,ht],styles:[".demo-datetime-picker[_ngcontent-%COMP%]{display:flex;width:100%;padding:0;flex-wrap:wrap}.demo-datetime-picker[_ngcontent-%COMP%]   .block[_ngcontent-%COMP%]{padding:30px 0;text-align:center;border-right:solid 1px var(--el-border-color);flex:1;min-width:300px}.demo-datetime-picker[_ngcontent-%COMP%]   .block[_ngcontent-%COMP%]:last-child{border-right:none}.demo-datetime-picker[_ngcontent-%COMP%]   .demonstration[_ngcontent-%COMP%]{display:block;color:var(--el-text-color-secondary);font-size:14px;margin-bottom:20px}@media (max-width: 768px){.demo-datetime-picker[_ngcontent-%COMP%]   .block[_ngcontent-%COMP%]{flex:100%;border-right:none;border-bottom:solid 1px var(--el-border-color)}.demo-datetime-picker[_ngcontent-%COMP%]   .block[_ngcontent-%COMP%]:last-child{border-bottom:none}[_ngcontent-%COMP%]:deep(.el-date-editor.el-input){width:100%}[_ngcontent-%COMP%]:deep(.el-date-editor.el-input__wrapper){width:100%;max-width:300px}}"]})};var Se=(o,e)=>e.stageId;function we(o,e){if(o&1&&(u(0,"a",4)(1,"span",6)(2,"span",7),D(),u(3,"svg",8),R(4,"path",9),d()(),T(),u(5,"span",10),s(6),d()()()),o&2){let t=c().$implicit;a(6),E(t.name)}}function Ee(o,e){if(o&1&&(u(0,"a",5)(1,"span",11),R(2,"span",12)(3,"span",13),d(),u(4,"span",14),s(5),d()()),o&2){let t=c().$implicit;a(5),E(t.name)}}function ke(o,e){if(o&1&&(u(0,"a",4)(1,"div",6)(2,"div",11),R(3,"div",15),d(),u(4,"p",10),s(5),d()()()),o&2){let t=c().$implicit;a(5),E(t.name)}}function Ie(o,e){if(o&1&&(u(0,"li"),g(1,we,7,1,"a",4)(2,Ee,6,1,"a",5)(3,ke,6,1,"a",4),d()),o&2){let t=e.$index,i=c();a(),f(i.isStageCompleted(t)?1:i.isCurrentStage(t)?2:3)}}function Fe(o,e){o&1&&(u(0,"div",3),D(),u(1,"svg",16),R(2,"path",17),d(),T(),u(3,"h3",18),s(4,"No Stages Available"),d(),u(5,"p",19),s(6,"Opportunity stages are not configured yet."),d()())}var wt=class o{opportunitiesService=y(M);opportunityStage=null;showStageNames=!0;clickable=!1;opportunityStages=[];loading=!1;ngOnInit(){this.loadOpportunityStages()}loadOpportunityStages(){this.loading=!0,this.opportunitiesService.getOpportunityStages().subscribe({next:e=>{this.opportunityStages=e.sort((t,i)=>t.sequence-i.sequence),this.loading=!1},error:e=>{console.error("Error fetching opportunity stages:",e),this.loading=!1}})}get currentStageIndex(){return!this.opportunityStage||!this.opportunityStages.length?-1:this.opportunityStages.findIndex(e=>e.stageId===this.opportunityStage.stageId)}isStageCompleted(e){let t=this.currentStageIndex;return t!==-1&&e<t}isCurrentStage(e){return this.currentStageIndex===e}isUpcomingStage(e){let t=this.currentStageIndex;return t!==-1&&e>t}get completionPercentage(){return!this.opportunityStages.length||this.currentStageIndex===-1?0:Math.round((this.currentStageIndex+1)/this.opportunityStages.length*100)}onStageClick(e,t){this.clickable&&console.log("Stage clicked:",e.name,"Index:",t)}static \u0275fac=function(t){return new(t||o)};static \u0275cmp=k({type:o,selectors:[["app-opportunity-stage-progress"]],inputs:{opportunityStage:"opportunityStage",showStageNames:"showStageNames",clickable:"clickable"},decls:6,vars:1,consts:[[1,"px-4","py-12","sm:px-6","lg:px-8"],["aria-label","Progress",1,"flex","justify-center"],["role","list",1,"space-y-6"],[1,"text-center","py-8"],[1,"group"],["aria-current","step",1,"flex","items-start"],[1,"flex","items-start"],[1,"relative","flex","size-5","shrink-0","items-center","justify-center"],["viewBox","0 0 20 20","fill","currentColor","data-slot","icon","aria-hidden","true",1,"size-full","text-primary-600","group-hover:text-primary-800","dark:text-primary-400","dark:group-hover:text-primary-300"],["d","M10 18a8 8 0 1 0 0-16 8 8 0 0 0 0 16Zm3.857-9.809a.75.75 0 0 0-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 1 0-1.06 1.061l2.5 2.5a.75.75 0 0 0 1.137-.089l4-5.5Z","clip-rule","evenodd","fill-rule","evenodd"],[1,"ml-3","text-sm","font-medium","text-gray-500","group-hover:text-gray-900","dark:text-gray-400","dark:group-hover:text-white"],["aria-hidden","true",1,"relative","flex","size-5","shrink-0","items-center","justify-center"],[1,"absolute","size-4","rounded-full","bg-primary-500/20","dark:bg-primary-900"],[1,"relative","block","size-2","rounded-full","bg-primary-600","dark:bg-primary-400"],[1,"ml-3","text-sm","font-medium","text-primary-600","dark:text-primary-400"],[1,"size-2","rounded-full","bg-gray-300","group-hover:bg-gray-400","dark:bg-white/15","dark:group-hover:bg-white/25"],["fill","none","viewBox","0 0 24 24","stroke","currentColor","aria-hidden","true",1,"mx-auto","h-12","w-12","text-gray-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z"],[1,"mt-2","text-sm","font-semibold","text-gray-900","dark:text-white"],[1,"mt-1","text-sm","text-gray-500","dark:text-gray-400"]],template:function(t,i){t&1&&(u(0,"div",0)(1,"nav",1)(2,"ol",2),I(3,Ie,4,1,"li",null,Se),d()(),g(5,Fe,7,0,"div",3),d()),t&2&&(a(3),F(i.opportunityStages),a(2),f(!i.loading&&i.opportunityStages.length===0?5:-1))},dependencies:[H],styles:[".stage-progress[_ngcontent-%COMP%]{transition:all .3s ease-in-out}.stage-progress[_ngcontent-%COMP%]:hover{transform:translateY(-1px)}.progress-bar[_ngcontent-%COMP%]{transition:width .5s ease-in-out}.stage-indicator[_ngcontent-%COMP%]{transition:all .2s ease-in-out}.stage-indicator[_ngcontent-%COMP%]:hover{transform:scale(1.1)}.current-stage-pulse[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_pulse 2s infinite}@keyframes _ngcontent-%COMP%_pulse{0%,to{opacity:1}50%{opacity:.5}}@media (max-width: 640px){.stage-name[_ngcontent-%COMP%]{font-size:.875rem}.stage-probability[_ngcontent-%COMP%]{font-size:.75rem}}"]})};var Et=class o{opportunity=null;activityRelatedTo=Qt.AccountActivityRelatedToEnum.OPPORTUNITY;activityRelatedEntityId="";ngOnInit(){this.activityRelatedEntityId=this.opportunity?this.opportunity.opportunityId:""}ngOnChanges(e){e.opportunity&&(this.activityRelatedEntityId=this.opportunity?this.opportunity.opportunityId:"")}static \u0275fac=function(t){return new(t||o)};static \u0275cmp=k({type:o,selectors:[["app-opportunity-summary"]],inputs:{opportunity:"opportunity",activityRelatedTo:"activityRelatedTo",activityRelatedEntityId:"activityRelatedEntityId"},features:[Q],decls:13,vars:5,consts:[[1,"pb-4"],[1,"grid","grid-cols-1","gap-6","mt-8","2xl:grid-cols-2"],[1,"col-span-2","rounded-2xl","shadow-sm","pb-2","h-fit"],[3,"contactInfo"],[1,"col-span-1","mt-6","border-gray-100","dark:border-white/10"],[1,"dark:divide-white/10"],[1,"px-4","py-2","sm:grid","sm:grid-cols-3","sm:gap-4","sm:px-0"],[1,"text-sm/6","font-medium","text-gray-900","dark:text-gray-100"],[1,"mt-1","text-sm/6","text-gray-700","sm:col-span-2","sm:mt-0","dark:text-gray-400"],[1,"mt-8"],[3,"accountId","activityRelatedTo","activityRelatedEntityId"]],template:function(t,i){t&1&&(r(0,"div",0)(1,"div",1)(2,"div",2),v(3,"app-contact-info-box",3),p(),r(4,"div",4)(5,"div",5)(6,"div",6)(7,"dt",7),s(8,"Opportunity Note"),p(),r(9,"dd",8),s(10),p()()()()(),r(11,"div",9),v(12,"app-accounts-activity-log",10),p()()),t&2&&(a(3),m("contactInfo",(i.opportunity==null?null:i.opportunity.contact)||null),a(7),b(" ",(i.opportunity==null?null:i.opportunity.notes)||"NA"),a(2),m("accountId",(i.opportunity==null?null:i.opportunity.accountId)||"")("activityRelatedTo",i.activityRelatedTo)("activityRelatedEntityId",i.activityRelatedEntityId))},dependencies:[H,Wt,zt],encapsulation:2})};var De=["opportunityForm"];function Te(o,e){if(o&1){let t=A();r(0,"button",25),S("click",function(){h(t);let n=c().$index,l=c();return x(l.setActiveTab(n))}),s(1),p()}if(o&2){let t=c().$implicit;a(),b(" ",t.label)}}function Ae(o,e){if(o&1){let t=A();r(0,"button",26),S("click",function(){h(t);let n=c().$index,l=c();return x(l.setActiveTab(n))}),s(1),p()}if(o&2){let t=c().$implicit;a(),b(" ",t.label)}}function Me(o,e){if(o&1&&g(0,Te,2,1,"button",23)(1,Ae,2,1,"button",24),o&2){let t=e.$index,i=c();f(t===i.activeTabIndex()?0:1)}}function Ne(o,e){if(o&1&&(r(0,"div",5),v(1,"app-opportunity-summary",27),p()),o&2){let t=c();a(),m("opportunity",t.opportunity())}}function Pe(o,e){if(o&1&&(r(0,"div",17),v(1,"app-opportunity-documents",28),p()),o&2){let t=c();a(),m("opportunityId",t.opportunityId)}}var kt=class o{opportunityForm;toastService=y(P);opportunityService=y(M);route=y(Lt);pageBreadcrumbs=[{label:"Home",path:"/"},{label:"Opportunities",path:"/opportunities/list"},{label:"#",path:"/opportunities/#"}];opportunityId="";opportunity=$(null);tabs=$([{label:"Summary",content:"Summary"},{label:"File Attachments",content:"Files"}]);activeTabIndex=$(0);ngOnInit(){this.route.params.subscribe(e=>{this.opportunityId=e.id,this.fetchOpportunityDetails(),this.pageBreadcrumbs[2].label=this.opportunityId||"#",this.pageBreadcrumbs[2].path=`/opportunities/${this.opportunityId}`})}setActiveTab(e){this.activeTabIndex.set(e)}fetchOpportunityDetails(){this.opportunityService.getOpportunityById(this.opportunityId,!0).subscribe({next:e=>{this.opportunity.set(e)},error:e=>{console.error("Error fetching opportunity details:",e)}})}makeOpportunityCloseWon(){let e=this.opportunity();e&&this.opportunityService.markOpportunityAsClosed(e.opportunityId,"Won").subscribe({next:t=>{t.opportunityId?(this.toastService.success("Opportunity stage updated successfully!"),this.opportunity.set(t)):this.toastService.error("Failed to update opportunity stage.")},error:t=>{console.error("Error updating opportunity stage:",t)}})}makeOpportunityCloseLost(){let e=this.opportunity();e&&this.opportunityService.markOpportunityAsClosed(e.opportunityId,"Lost").subscribe({next:t=>{t.opportunityId?(this.toastService.success("Opportunity stage updated successfully!"),this.opportunity.set(t)):this.toastService.error("Failed to update opportunity stage.")},error:t=>{console.error("Error updating opportunity stage:",t)}})}openOpportunityFormModal(){this.opportunityForm.open()}closeOpportunityFormModal(){this.opportunityForm.close()}onOpportunityFormSubmit(e){if(!e){this.closeOpportunityFormModal();return}e.opportunityId&&this.updateOpportunity(e.opportunityId,e)}updateOpportunity(e,t){this.opportunityService.updateOpportunity(e,{accountId:t.accountId,contactId:t.contactId,opportunityName:t.opportunityName,opportunityOwnerId:t.opportunityOwnerId,stageId:t.stageId,status:t.status,closedDate:t.closedDate?new Date(t.closedDate).toISOString():null,expectedCloseDate:t.expectedCloseDate?new Date(t.expectedCloseDate).toISOString():null,notes:t.notes}).subscribe({next:i=>{if(i.opportunityId){this.closeOpportunityFormModal(),this.toastService.success("Opportunity updated successfully!"),this.opportunity.set(i);return}else this.toastService.error("Failed to update opportunity. Please try again.")},error:i=>{console.error("Error updating opportunity:",i)}})}static \u0275fac=function(t){return new(t||o)};static \u0275cmp=k({type:o,selectors:[["app-opportunity-main"]],viewQuery:function(t,i){if(t&1&&W(De,5),t&2){let n;Z(n=Y())&&(i.opportunityForm=n.first)}},decls:37,vars:7,consts:[["opportunityForm",""],[1,"pb-6","px-4"],[3,"breadcrumbs"],[1,"mt-4","border-b","border-gray-200","pb-5"],[3,"markAsLost","markAsWon","opportunity"],[1,""],[1,"grid","grid-cols-1","sm:grid-cols-1","md:grid-cols-6","lg:grid-cols-6","gap-4","mt-6"],[1,"md:col-span-4","lg:col-span-4"],[1,"grid","grid-cols-1","sm:hidden"],["aria-label","Select a tab",1,"col-start-1","row-start-1","w-full","appearance-none","rounded-md","bg-white","py-2","pr-8","pl-3","text-base","text-gray-900","outline-1","-outline-offset-1","outline-gray-300","focus:outline-2","focus:-outline-offset-2","focus:outline-indigo-600","dark:bg-gray-800/50","dark:text-gray-100","dark:outline-white/10","dark:*:bg-gray-800","dark:focus:outline-indigo-500"],["selected",""],["viewBox","0 0 16 16","fill","currentColor","data-slot","icon","aria-hidden","true",1,"pointer-events-none","col-start-1","row-start-1","mr-2","size-5","self-center","justify-self-end","fill-gray-500","dark:fill-gray-400"],["d","M4.22 6.22a.75.75 0 0 1 1.06 0L8 8.94l2.72-2.72a.75.75 0 1 1 1.06 1.06l-3.25 3.25a.75.75 0 0 1-1.06 0L4.22 7.28a.75.75 0 0 1 0-1.06Z","clip-rule","evenodd","fill-rule","evenodd"],[1,"hidden","sm:block"],[1,"flex","justify-between"],[1,"flex","space-x-4"],[1,"px-3","py-1.5","text-xs","font-medium","text-primary-500","hover:underline","hover:text-primary-500/80","focus:outline-none",3,"click"],[1,"mt-12"],[1,"md:col-span-2","lg:col-span-2"],[3,"opportunityStage"],[3,"closeModal","modalId"],[1,"mt-4"],[3,"formSubmit","opportunityId"],["type","button",1,"rounded-md","bg-primary-500/10","px-3","py-2","text-sm","font-medium","text-primary-500","dark:bg-primary-500/20","dark:text-primary-300"],["type","button",1,"rounded-md","px-3","py-2","text-sm","font-medium","text-gray-500","hover:text-gray-700","dark:text-gray-400","dark:hover:text-gray-200"],["type","button",1,"rounded-md","bg-primary-500/10","px-3","py-2","text-sm","font-medium","text-primary-500","dark:bg-primary-500/20","dark:text-primary-300",3,"click"],["type","button",1,"rounded-md","px-3","py-2","text-sm","font-medium","text-gray-500","hover:text-gray-700","dark:text-gray-400","dark:hover:text-gray-200",3,"click"],[3,"opportunity"],[3,"opportunityId"]],template:function(t,i){if(t&1){let n=A();r(0,"div",1),v(1,"app-page-heading",2),r(2,"div",3)(3,"app-opportunity-header-box",4),S("markAsLost",function(){return h(n),x(i.makeOpportunityCloseLost())})("markAsWon",function(){return h(n),x(i.makeOpportunityCloseWon())}),p()(),r(4,"div",5)(5,"div",6)(6,"div",7)(7,"div",8)(8,"select",9)(9,"option"),s(10,"My Account"),p(),r(11,"option"),s(12,"Company"),p(),r(13,"option",10),s(14,"Team Members"),p(),r(15,"option"),s(16,"Billing"),p()(),D(),r(17,"svg",11),v(18,"path",12),p()(),T(),r(19,"div",13)(20,"el-tab-group")(21,"div",14)(22,"el-tab-list",15),I(23,Me,2,1,null,null,V),p(),r(25,"div")(26,"a",16),S("click",function(){return h(n),x(i.openOpportunityFormModal())}),s(27," Edit Opportunity"),p()()(),r(28,"el-tab-panels",5),g(29,Ne,2,1,"div",5),g(30,Pe,2,1,"div",17),p()()()(),r(31,"div",18),v(32,"app-opportunity-stage-progress",19),p()()()(),r(33,"app-modal-medium",20,0),S("closeModal",function(){return h(n),x(i.closeOpportunityFormModal())}),r(35,"div",21)(36,"app-opportunity-form",22),S("formSubmit",function(O){return h(n),x(i.onOpportunityFormSubmit(O))}),p()()()}if(t&2){let n,l;a(),m("breadcrumbs",i.pageBreadcrumbs),a(2),m("opportunity",i.opportunity()),a(20),F(i.tabs()),a(6),f(i.activeTabIndex()===0?29:-1),a(),f(i.activeTabIndex()===1?30:-1),a(2),m("opportunityStage",((n=i.opportunity())==null?null:n.opportunityStage)||null),a(),m("modalId","opportunity-form-modal"),a(3),m("opportunityId",((l=i.opportunity())==null?null:l.opportunityId)||null)}},dependencies:[St,wt,H,Et,gt,ft,K,Ot],encapsulation:2})};var jo=[{path:"list",component:vt},{path:":id/view",component:kt}];export{jo as OPPORTUNITY_ROUTES};
